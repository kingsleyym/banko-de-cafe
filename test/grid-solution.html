<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test 1: CSS Grid Carousel + Parallax</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/carousel.css">
    <link rel="stylesheet" href="../assets/parallax.css">
    <style>
        /* BASE STYLES */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            overflow-x: hidden !important;
            max-width: 100vw;
            font-family: 'Poppins', sans-serif;
        }

        /* HERO SECTION */
        .hero-section {
            position: relative;
            width: 100%;
            height: 100vh;
            min-height: 600px;
            background: radial-gradient(circle at center bottom, 
                rgba(255, 165, 0, 0.3) 0%, 
                rgba(255, 140, 0, 0.2) 30%, 
                rgba(255, 255, 255, 0.1) 60%, 
                transparent 100%);
            overflow: hidden;
        }

        /* NAVIGATION */
        .nav {
            position: relative;
            z-index: 100;
            padding: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: clamp(20px, 3vw, 24px);
            font-weight: 700;
            color: #333;
        }

        .nav-links {
            display: flex;
            gap: clamp(20px, 4vw, 40px);
            list-style: none;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            font-size: clamp(14px, 2vw, 16px);
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: #ff8c00;
        }

        /* MOBILE NAV */
        @media (max-width: 768px) {
            .nav-links {
                gap: 15px;
            }
        }

        /* CONTENT SECTION */
        .content-section {
            position: relative;
            z-index: 10;
            background: white;
            min-height: 100vh;
            padding: 4rem 2rem;
        }

        .section-title {
            text-align: center;
            font-size: clamp(28px, 5vw, 36px);
            font-weight: 700;
            color: #333;
            margin-bottom: 3rem;
        }
    </style>
</head>
<body>
    <!-- HERO SECTION -->
    <section class="hero-section">
        <!-- NAVIGATION -->
        <nav class="nav">
            <div class="logo">Banko de Café</div>
            <ul class="nav-links">
                <li><a href="#">Home</a></li>
                <li><a href="#">Produkte</a></li>
                <li><a href="#">Über uns</a></li>
                <li><a href="#">Kontakt</a></li>
            </ul>
        </nav>

        <!-- BOWL CONTAINER -->
        <div class="bowl-container">
            <div class="bowl bowl-parallax-fast" id="parallaxBowl">
                <img src="../assets/hero.jpg" alt="Coffee Bowl">
            </div>
        </div>
    </section>

    <!-- CONTENT SECTION -->
    <section class="content-section">
        <h2 class="section-title">Unsere Produkte</h2>
        
        <!-- CAROUSEL WRAPPER -->
        <div class="carousel-wrapper">
            <!-- NAVIGATION BUTTONS -->
            <button class="carousel-nav prev" id="prevBtn">‹</button>
            <button class="carousel-nav next" id="nextBtn">›</button>
            
            <!-- CAROUSEL CONTAINER -->
            <div class="carousel-container">
                <div class="carousel" id="productCarousel">
                    <!-- PRODUCT CARD 1 -->
                    <div class="product-card active" data-index="0">
                        <div class="product-image">
                            <img src="../assets/hero.jpg" alt="Espresso">
                        </div>
                        <div class="product-content">
                            <h3 class="product-name">Premium Espresso</h3>
                            <p class="product-description">Intensiver Geschmack aus besten Bohnen</p>
                            <div class="product-footer">
                                <span class="product-size">250g</span>
                                <span class="product-price">€12.90</span>
                            </div>
                        </div>
                    </div>

                    <!-- PRODUCT CARD 2 -->
                    <div class="product-card" data-index="1">
                        <div class="product-image">
                            <img src="../assets/hero.jpg" alt="Cappuccino">
                        </div>
                        <div class="product-content">
                            <h3 class="product-name">Cappuccino Blend</h3>
                            <p class="product-description">Perfekte Balance zwischen Espresso und Milch</p>
                            <div class="product-footer">
                                <span class="product-size">500g</span>
                                <span class="product-price">€18.50</span>
                            </div>
                        </div>
                    </div>

                    <!-- PRODUCT CARD 3 -->
                    <div class="product-card" data-index="2">
                        <div class="product-image">
                            <img src="../assets/hero.jpg" alt="Americano">
                        </div>
                        <div class="product-content">
                            <h3 class="product-name">House Americano</h3>
                            <p class="product-description">Milder Geschmack für jeden Tag</p>
                            <div class="product-footer">
                                <span class="product-size">1kg</span>
                                <span class="product-price">€24.90</span>
                            </div>
                        </div>
                    </div>

                    <!-- PRODUCT CARD 4 -->
                    <div class="product-card" data-index="3">
                        <div class="product-image">
                            <img src="../assets/hero.jpg" alt="Latte">
                        </div>
                        <div class="product-content">
                            <h3 class="product-name">Vanilla Latte</h3>
                            <p class="product-description">Cremig-süßer Genuss mit Vanille</p>
                            <div class="product-footer">
                                <span class="product-size">250g</span>
                                <span class="product-price">€15.90</span>
                            </div>
                        </div>
                    </div>

                    <!-- PRODUCT CARD 5 -->
                    <div class="product-card" data-index="4">
                        <div class="product-image">
                            <img src="../assets/hero.jpg" alt="Mocha">
                        </div>
                        <div class="product-content">
                            <h3 class="product-name">Chocolate Mocha</h3>
                            <p class="product-description">Schokoladiger Traum für Genießer</p>
                            <div class="product-footer">
                                <span class="product-size">500g</span>
                                <span class="product-price">€19.90</span>
                            </div>
                        </div>
                    </div>

                    <!-- PRODUCT CARD 6 -->
                    <div class="product-card" data-index="5">
                        <div class="product-image">
                            <img src="../assets/hero.jpg" alt="Cold Brew">
                        </div>
                        <div class="product-content">
                            <h3 class="product-name">Cold Brew Special</h3>
                            <p class="product-description">Erfrischend kalt gebrühter Kaffee</p>
                            <div class="product-footer">
                                <span class="product-size">1kg</span>
                                <span class="product-price">€22.90</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // ==========================================
        // PROFESSIONELLE CAROUSEL LOGIK
        // ==========================================
        class ResponsiveCarousel {
            constructor() {
                this.carousel = document.getElementById('productCarousel');
                this.cards = this.carousel.querySelectorAll('.product-card');
                this.prevBtn = document.getElementById('prevBtn');
                this.nextBtn = document.getElementById('nextBtn');
                this.currentIndex = 0;
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.updateActiveCards();
                this.setupIntersectionObserver();
            }
            
            setupEventListeners() {
                this.prevBtn.addEventListener('click', () => this.navigate(-1));
                this.nextBtn.addEventListener('click', () => this.navigate(1));
                
                // Touch/Scroll Support
                this.carousel.addEventListener('scroll', this.throttle(() => {
                    this.updateActiveCardsFromScroll();
                }, 100));
            }
            
            setupIntersectionObserver() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        const card = entry.target;
                        const index = parseInt(card.dataset.index);
                        
                        if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
                            this.currentIndex = index;
                            this.updateActiveCards();
                        }
                    });
                }, {
                    root: this.carousel,
                    threshold: [0.5, 0.8]
                });
                
                this.cards.forEach(card => observer.observe(card));
            }
            
            navigate(direction) {
                this.currentIndex = Math.max(0, Math.min(this.cards.length - 1, this.currentIndex + direction));
                this.scrollToCard(this.currentIndex);
            }
            
            scrollToCard(index) {
                const card = this.cards[index];
                if (!card) return;
                
                const cardRect = card.getBoundingClientRect();
                const carouselRect = this.carousel.getBoundingClientRect();
                const scrollLeft = this.carousel.scrollLeft;
                
                const targetScroll = scrollLeft + cardRect.left - carouselRect.left - (carouselRect.width - cardRect.width) / 2;
                
                this.carousel.scrollTo({
                    left: targetScroll,
                    behavior: 'smooth'
                });
                
                setTimeout(() => this.updateActiveCards(), 300);
            }
            
            updateActiveCardsFromScroll() {
                const carouselCenter = this.carousel.scrollLeft + this.carousel.offsetWidth / 2;
                let closestIndex = 0;
                let closestDistance = Infinity;
                
                this.cards.forEach((card, index) => {
                    const cardCenter = card.offsetLeft + card.offsetWidth / 2;
                    const distance = Math.abs(carouselCenter - cardCenter);
                    
                    if (distance < closestDistance) {
                        closestDistance = distance;
                        closestIndex = index;
                    }
                });
                
                if (closestIndex !== this.currentIndex) {
                    this.currentIndex = closestIndex;
                    this.updateActiveCards();
                }
            }
            
            updateActiveCards() {
                // Bestimme aktive Karten basierend auf Viewport
                const viewport = window.innerWidth;
                let activeCards = [];
                
                if (viewport >= 1200) {
                    // Desktop: 2 zentrale Karten
                    activeCards = [this.currentIndex, this.currentIndex + 1];
                } else {
                    // Tablet/Mobile: 1 zentrale Karte
                    activeCards = [this.currentIndex];
                }
                
                // Update card states
                this.cards.forEach((card, index) => {
                    card.classList.toggle('active', activeCards.includes(index));
                });
            }
            
            throttle(func, delay) {
                let timeoutId;
                let lastExecTime = 0;
                return function (...args) {
                    const currentTime = Date.now();
                    
                    if (currentTime - lastExecTime > delay) {
                        func.apply(this, args);
                        lastExecTime = currentTime;
                    } else {
                        clearTimeout(timeoutId);
                        timeoutId = setTimeout(() => {
                            func.apply(this, args);
                            lastExecTime = Date.now();
                        }, delay - (currentTime - lastExecTime));
                    }
                };
            }
        }
        
        // ==========================================
        // PROFESSIONELLER PARALLAX EFFEKT
        // ==========================================
        class SmoothParallax {
            constructor() {
                this.bowl = document.getElementById('parallaxBowl');
                this.isScrolling = false;
                this.scrollY = 0;
                this.targetY = 0;
                
                this.init();
            }
            
            init() {
                if (!this.bowl) return;
                
                // Smooth scroll tracking
                window.addEventListener('scroll', () => {
                    this.targetY = window.pageYOffset;
                    
                    if (!this.isScrolling) {
                        this.isScrolling = true;
                        this.updateParallax();
                    }
                });
                
                // Resize handler
                window.addEventListener('resize', this.throttle(() => {
                    this.updateParallax();
                }, 100));
            }
            
            updateParallax() {
                // Smooth interpolation
                this.scrollY += (this.targetY - this.scrollY) * 0.1;
                
                // Calculate parallax offset
                const parallaxSpeed = 0.3;
                const offset = this.scrollY * parallaxSpeed;
                
                // Apply transform
                this.bowl.style.setProperty('--parallax-offset', `${offset}px`);
                
                // Continue animation
                if (Math.abs(this.targetY - this.scrollY) > 0.1) {
                    requestAnimationFrame(() => this.updateParallax());
                } else {
                    this.isScrolling = false;
                }
            }
            
            throttle(func, delay) {
                let timeoutId;
                let lastExecTime = 0;
                return function (...args) {
                    const currentTime = Date.now();
                    
                    if (currentTime - lastExecTime > delay) {
                        func.apply(this, args);
                        lastExecTime = currentTime;
                    } else {
                        clearTimeout(timeoutId);
                        timeoutId = setTimeout(() => {
                            func.apply(this, args);
                            lastExecTime = Date.now();
                        }, delay - (currentTime - lastExecTime));
                    }
                };
            }
        }
        
        // ==========================================
        // INITIALISIERUNG
        // ==========================================
        document.addEventListener('DOMContentLoaded', () => {
            new ResponsiveCarousel();
            new SmoothParallax();
        });
    </script>
</body>
</html>
